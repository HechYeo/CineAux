<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Choose Seat</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: black;
            color: white;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            height: 100vh;
            justify-content: space-between;
            overflow: hidden;
            font-size: 12px;
        }

        .movie-title h1, .movie-title h2, .movie-title h3 {
            font-size: 1.5em;
            text-align: center;
        }

        .seats-container {
            display: flex;
            flex-direction: column;
            gap: 1em;
            flex-grow: 1;
            overflow: hidden;
        }

        .row {
            display: grid;
            grid-template-columns: repeat(20, 1fr);
            justify-items: center;
            gap: 0.8em;
        }

        .seat {
            width: 3em;
            height: 3.5em;
            background-color: #007bff;
            color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            border-radius: 5px;
            cursor: pointer;
        }

        .seat:hover {
            background-color: #4682b4;
            transform: scale(1.1);
        }

        .seat.selected {
            background-color: white;
            color: black;  /* Change text color to black when selected */
        }

        .seat.booked {
            background-color: #dc3545;
            cursor: not-allowed;
        }

        .screen-line {
            grid-column: 1 / -1;
            height: 1.5em;
            margin-bottom: 1.5em;
            background: linear-gradient(to right, transparent 10%, #fff 50%, transparent 90%);
            border-radius: 50%;
        }

        .screen-text {
            text-align: center;
            font-size: 1.2em;
            color: white;
            margin-bottom: 1.5em;
            font-weight: bold;
        }
        .modal-footer {
            display: flex;
            justify-content: flex-end; /* Align buttons to the right */
            gap: 10px; /* Space between the buttons */
        }

        .btn-cancel {
            background-color: #dc3545;
            color: white;
            padding: 0.8em 1.5em;
            border-radius: 8px;
            font-size: 1.2em;
            text-decoration: none;
            transition: background-color 0.3s;
            align-self: flex-end;
            margin-bottom: 1.2em;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
        }

        .btn-cancel:hover {
            background-color: #c82333;
        }

        .btn-proceed {
            background-color: #28a745; /* Green */
            color: white;
            padding: 0.8em 1.5em;
            border-radius: 8px;
            font-size: 1.2em;
            text-decoration: none;
            transition: background-color 0.3s;
            align-self: flex-end;
            margin-bottom: 1.2em;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
        }

        .btn-proceed:hover {
            background-color: #218838;
        }


        /* Responsive styles */
        @media (max-width: 1200px) {
            body {
                font-size: 10px;
            }

            .seats-container {
                gap: 0.8em;
            }

            .seat {
                width: 2.5em;
                height: 3em;
            }

            .screen-text {
                font-size: 1em;
            }

            .btn-cancel {
                font-size: 1.1em;
            }
        }

        @media (max-width: 800px) {
            body {
                font-size: 8px;
            }

            .seats-container {
                gap: 0.6em;
            }

            .seat {
                width: 2em;
                height: 2.5em;
            }

            .screen-text {
                font-size: 0.9em;
            }

            .btn-cancel {
                font-size: 1em;
            }
        }
        .arrow-seat {
            grid-column: span 3;
            text-align: center;
        }

        .arrow-left {
            font-size: 2.5em; /* Smaller arrow size */
            color: white;
        }

        .arrow-text {
            font-size: 1.2em; /* Adjusted smaller text size */
            color: white;
            margin-top: 1em;
        }
        

    </style>
</head>
<body>

    <div class="movie-title">
        <h1>Choose Your Seat for:</h1>
        <h2>{{ showtime.movie.title }}</h2>
        <h3> at {{ showtime.time|date:"G:i" }}</h3>
    </div>

    <div class="seats-container">
        <!-- Add the screen line above the M row -->
        <div class="screen-line"></div>
        
        <!-- Add text under the screen line -->
        <div class="screen-text">Leinwand</div>
        
        <!-- Row M - 14 seats -->
        <div class="row" style="grid-template-columns: repeat(15, 1fr) 1fr">
            <div class="seat">M1</div>
            <div class="seat">M2</div>
            <div class="seat">M3</div>
            <div class="seat">M4</div>
            <div class="seat">M5</div>
            <div class="seat">M6</div>
            <div class="seat">M7</div>
            <div class="seat">M8</div>
            <div class="seat">M9</div>
            <div class="seat">M10</div>
            <div class="seat">M11</div>
            <div class="seat">M12</div>
            <div class="seat">M13</div>
            <div class="seat">M14</div>
        </div>
        
        <!-- Row L - 18 seats -->
        <div class="row" style="grid-template-columns: repeat(20, 1fr)">
            <div class="seat">L1</div>
            <div class="seat">L2</div>
            <div class="seat">L3</div>
            <div class="seat">L4</div>
            <div class="seat">L5</div>
            <div class="seat">L6</div>
            <div class="seat">L7</div>
            <div class="seat">L8</div>
            <div class="seat">L9</div>
            <div class="seat">L10</div>
            <div class="seat">L11</div>
            <div class="seat">L12</div>
            <div class="seat">L13</div>
            <div class="seat">L14</div>
            <div class="seat">L15</div>
            <div class="seat">L16</div>
            <div class="seat">L17</div>
            <div class="seat">L18</div>
            <div class="seat" style="visibility: hidden;"></div>
            <div class="seat" style="visibility: hidden;"></div>
        </div>
        <div class="row" style="grid-template-columns: repeat(17, 1fr) 3fr;">
            <div class="seat">K1</div>
            <div class="seat">K2</div>
            <div class="seat">K3</div>
            <div class="seat">K4</div>
            <div class="seat">K5</div>
            <div class="seat">K6</div>
            <div class="seat">K7</div>
            <div class="seat">K8</div>
            <div class="seat">K9</div>
            <div class="seat">K10</div>
            <div class="seat">K11</div>
            <div class="seat">K12</div>
            <div class="seat">K13</div>
            <div class="seat">K14</div>
            <div class="seat">K15</div>
            <div class="seat" style="display: none;"></div>
            <div class="arrow-seat">
                <!-- Large white arrow replacing 3 invisible seats -->
                <span class="arrow-left">&#8592;</span>
                <div class="arrow-text">Eingang</div>
            </div>
        </div>
        <div class="row" style="grid-template-columns: repeat(20, 1fr)">
            <div class="seat">J1</div>
            <div class="seat">J2</div>
            <div class="seat">J3</div>
            <div class="seat">J4</div>
            <div class="seat">J5</div>
            <div class="seat">J6</div>
            <div class="seat">J7</div>
            <div class="seat">J8</div>
            <div class="seat">J9</div>
            <div class="seat">J10</div>
            <div class="seat">J11</div>
            <div class="seat">J12</div>
            <div class="seat">J13</div>
            <div class="seat">J14</div>
            <div class="seat">J15</div>
            <!-- Empty spaces (gap) -->
            <div class="seat" style="display: none;"></div>
            <div class="seat" style="display: none;"></div>
            <div class="seat" style="display: none;"></div>
        </div>
        <div class="row" style="grid-template-columns: repeat(20, 1fr)">
            <div class="seat">I1</div>
            <div class="seat">I2</div>
            <div class="seat">I3</div>
            <div class="seat">I4</div>
            <div class="seat">I5</div>
            <div class="seat">I6</div>
            <div class="seat">I7</div>
            <div class="seat">I8</div>
            <div class="seat">I9</div>
            <div class="seat">I10</div>
            <div class="seat">I11</div>
            <div class="seat">I12</div>
            <div class="seat">I13</div>
            <div class="seat">I14</div>
            <div class="seat">I15</div>
            <!-- Empty spaces (gap) -->
            <div class="seat" style="visibility: hidden;"></div>
            <div class="seat" style="visibility: hidden;"></div>
            <div class="seat" style="visibility: hidden;"></div>
        </div>
        <!-- Row G-K - 17 seats with empty space after 15th seat -->
        <!-- Each of these rows will have 15 seats followed by 3 empty divs to create the gap -->
        <div class="row" style="grid-template-columns: repeat(20, 1fr)">
            <div class="seat">H1</div>
            <div class="seat">H2</div>
            <div class="seat">H3</div>
            <div class="seat">H4</div>
            <div class="seat">H5</div>
            <div class="seat">H6</div>
            <div class="seat">H7</div>
            <div class="seat">H8</div>
            <div class="seat">H9</div>
            <div class="seat">H10</div>
            <div class="seat">H11</div>
            <div class="seat">H12</div>
            <div class="seat">H13</div>
            <div class="seat">H14</div>
            <div class="seat">H15</div>
            <!-- Empty spaces (gap) -->
            <div class="seat" style="visibility: hidden;"></div>
            <div class="seat" style="visibility: hidden;"></div>
            <div class="seat" style="visibility: hidden;"></div>
        </div>
        <div class="row" style="grid-template-columns: repeat(20, 1fr)">
            <div class="seat">G1</div>
            <div class="seat">G2</div>
            <div class="seat">G3</div>
            <div class="seat">G4</div>
            <div class="seat">G5</div>
            <div class="seat">G6</div>
            <div class="seat">G7</div>
            <div class="seat">G8</div>
            <div class="seat">G9</div>
            <div class="seat">G10</div>
            <div class="seat">G11</div>
            <div class="seat">G12</div>
            <div class="seat">G13</div>
            <div class="seat">G14</div>
            <div class="seat">G15</div>
            <!-- Empty spaces (gap) -->
            <div class="seat" style="visibility: hidden;"></div>
            <div class="seat" style="visibility: hidden;"></div>
            <div class="seat" style="visibility: hidden;"></div>
            <div class="seat">G16</div>
            <div class="seat">G17</div>
        </div>
        <div class="row" style="grid-template-columns: repeat(20, 1fr)">
            <div class="seat">F1</div>
            <div class="seat">F2</div>
            <div class="seat">F3</div>
            <div class="seat">F4</div>
            <div class="seat">F5</div>
            <div class="seat">F6</div>
            <div class="seat">F7</div>
            <div class="seat">F8</div>
            <div class="seat">F9</div>
            <div class="seat">F10</div>
            <div class="seat">F11</div>
            <div class="seat">F12</div>
            <div class="seat">F13</div>
            <div class="seat">F14</div>
            <div class="seat">F15</div>
            <!-- Empty spaces (gap) -->
            <div class="seat" style="visibility: hidden;"></div>
            <div class="seat" style="visibility: hidden;"></div>
            <div class="seat" style="visibility: hidden;"></div>
            <div class="seat">F16</div>
            <div class="seat">F17</div>
        </div>
        <div class="row" style="grid-template-columns: repeat(20, 1fr)">
            <div class="seat">E1</div>
            <div class="seat">E2</div>
            <div class="seat">E3</div>
            <div class="seat">E4</div>
            <div class="seat">E5</div>
            <div class="seat">E6</div>
            <div class="seat">E7</div>
            <div class="seat">E8</div>
            <div class="seat">E9</div>
            <div class="seat">E10</div>
            <div class="seat">E11</div>
            <div class="seat">E12</div>
            <div class="seat">E13</div>
            <div class="seat">E14</div>
            <div class="seat">E15</div>
            <!-- Empty spaces (gap) -->
            <div class="seat" style="visibility: hidden;"></div>
            <div class="seat" style="visibility: hidden;"></div>
            <div class="seat" style="visibility: hidden;"></div>
            <div class="seat">E16</div>
            <div class="seat">E17</div>
        </div>
        <!-- Rows D to G - 17 seats with empty spaces after 15th seat -->
        <div class="row" style="grid-template-columns: repeat(20, 1fr)">
            <div class="seat">D1</div>
            <div class="seat">D2</div>
            <div class="seat">D3</div>
            <div class="seat">D4</div>
            <div class="seat">D5</div>
            <div class="seat">D6</div>
            <div class="seat">D7</div>
            <div class="seat">D8</div>
            <div class="seat">D9</div>
            <div class="seat">D10</div>
            <div class="seat">D11</div>
            <div class="seat">D12</div>
            <div class="seat">D13</div>
            <div class="seat">D14</div>
            <div class="seat">D15</div>
            <!-- Empty spaces (gap) -->
            <div class="seat" style="visibility: hidden;"></div>
            <div class="seat" style="visibility: hidden;"></div>
            <div class="seat" style="visibility: hidden;"></div>
            <div class="seat">D16</div>
            <div class="seat">D17</div>
        </div>

            <!-- Row C - 11 seats -->
        <div class="row" style="grid-template-columns: repeat(12, 1fr)">
            <div class="seat">C1</div>
            <div class="seat">C2</div>
            <div class="seat">C3</div>
            <div class="seat">C4</div>
            <div class="seat">C5</div>
            <div class="seat">C6</div>
            <div class="seat">C7</div>
            <div class="seat">C8</div>
            <div class="seat">C9</div>
            <div class="seat" style="visibility: hidden;"></div>
            <div class="seat">C10</div>
            <div class="seat">C11</div>
        </div>

        <!-- Row B - 8 seats -->
        <div class="row" style="grid-template-columns: repeat(12, 1fr)">
            <div class="seat">B1</div>
            <div class="seat">B2</div>
            <div class="seat">B3</div>
            <div class="seat" style="visibility: hidden;"></div>
            <div class="seat" style="visibility: hidden;"></div>
            <div class="seat" style="visibility: hidden;"></div>
            <div class="seat" style="visibility: hidden;"></div>
            <div class="seat">B4</div>
            <div class="seat">B5</div>
            <div class="seat">B6</div>
            <div class="seat">B7</div>
            <div class="seat">B8</div>
        </div>

        <!-- Row A - 2 seats -->
        <div class="row" style="grid-template-columns: repeat(12, 1fr)">
            <div class="seat">A1</div>
            <div class="seat">A2</div>
            <div class="seat">A3</div>
            <div class="seat" style="visibility: hidden;"></div>
            <div class="seat" style="visibility: hidden;"></div>
            <div class="seat" style="visibility: hidden;"></div>
            <div class="seat" style="visibility: hidden;"></div>
            <div class="seat" style="visibility: hidden;"></div>
            <div class="seat" style="visibility: hidden;"></div>
            <div class="seat" style="visibility: hidden;"></div>
            <div class="seat" style="visibility: hidden;"></div>
            <div class="seat" style="visibility: hidden;"></div>
        </div>
        
    </div>
    
    <!-- Modal Footer -->
    <div class="modal-footer">
        <a href="{% url 'book_seats' %}" class="btn-proceed" data-movie="{{ movie.id }}" data-showtime="{{ showtime.id }}">
            Proceed to Book Seats
        </a>
        <!-- Cancel Button -->
        <a href="{% url 'movie_showtimes' movie.id %}" class="btn-cancel">Cancel</a>
        <!-- Proceed to Booking Button with data attributes for movie and showtime IDs -->
    </div>


  <script>
    // Toggle selection on seat click
    const seats = document.querySelectorAll('.seat');
    seats.forEach(seat => {
        seat.addEventListener('click', () => {
            seat.classList.toggle('selected');
        });
    });
  
    // When clicking "Proceed to Book Seats", gather selected seat labels and redirect
    const proceedBtn = document.querySelector('.btn-proceed');
    proceedBtn.addEventListener('click', function(e) {
        e.preventDefault();
        let selectedSeats = [];
        document.querySelectorAll('.seat.selected').forEach(seat => {
            let seatNumber = seat.textContent.trim();
            selectedSeats.push(seatNumber);
        });
        
        // Debug: Check what seats have been selected
        console.log("Selected Seats: ", selectedSeats);
        
        if (selectedSeats.length === 0) {
            alert("Please select at least one seat.");
            return;
        }
        
        let movieId = proceedBtn.getAttribute('data-movie');
        let showtimeId = proceedBtn.getAttribute('data-showtime');
        let seatsParam = encodeURIComponent(selectedSeats.join(','));
        let url = proceedBtn.href + "?movie=" + movieId + "&showtime=" + showtimeId + "&seats=" + seatsParam;
        
        // Debug: Check the final URL before redirecting
        console.log("Redirecting to: ", url);
        
        window.location.href = url;
    });
  </script>
  
</body>
</html>
